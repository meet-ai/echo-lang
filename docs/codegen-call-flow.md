# Echoä»£ç ç”Ÿæˆå™¨è°ƒç”¨æµç¨‹

## ğŸ“‹ æ¦‚è¿°

åŸºäºå·²å®Œæˆçš„DDDé¢†åŸŸå»ºæ¨¡é‡æ„ï¼Œå±•ç¤ºEchoç¼–è¯‘å™¨ä»ASTåˆ°LLVM IRå¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è°ƒç”¨æµç¨‹ã€‚

**æ ¸å¿ƒè®¾è®¡åŸåˆ™**ï¼š
1. åˆ†å±‚æ¶æ„ï¼šApplicationå±‚ç¼–æ’ã€Domainå±‚ä¸šåŠ¡é€»è¾‘ã€Infrastructureå±‚æŠ€æœ¯å®ç°
2. é¢†åŸŸæ¨¡å‹é©±åŠ¨ï¼šé€šè¿‡èšåˆæ ¹å’Œé¢†åŸŸæœåŠ¡å°è£…ä¸šåŠ¡é€»è¾‘
3. æ¥å£é©±åŠ¨ï¼šé€šè¿‡æ¸…æ™°çš„æœåŠ¡æ¥å£å®ç°ä¾èµ–å€’ç½®
4. ç±»å‹å®‰å…¨ï¼šé¿å…interface{}æ»¥ç”¨ï¼Œä½¿ç”¨å…·ä½“çš„é¢†åŸŸç±»å‹

---

## æ•´ä½“æµç¨‹å›¾

```
ç”¨æˆ·è¾“å…¥Echoæºä»£ç 
    â†“
[Application å±‚] main.go - å‘½ä»¤è¡Œå…¥å£
    â†“
[Application å±‚] main.generateLLVMExecutable()
    â”œâ”€â”€ è§£æASTï¼ˆfrontendæœåŠ¡ï¼‰
    â”‚   â””â”€â”€ Parser.Parse() â†’ *entities.Program
    â””â”€â”€ ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶
        â”œâ”€â”€ [Application å±‚] CodeGenerator.GenerateCode()
        â”‚   â””â”€â”€ [Domain å±‚] LLVMGenerator.GenerateCode()
        â”‚       â”œâ”€â”€ å£°æ˜è¿è¡Œæ—¶å‡½æ•°
        â”‚       â”‚   â””â”€â”€ declareRuntime() â†’ å¤–éƒ¨å‡½æ•°å£°æ˜
        â”‚       â”œâ”€â”€ ç”Ÿæˆç¨‹åºä¸»ä½“
        â”‚       â”‚   â””â”€â”€ generateProgramBody() â†’ ä¸»å‡½æ•°å’Œç”¨æˆ·å‡½æ•°
        â”‚       â””â”€â”€ è¿”å›LLVM IRå­—ç¬¦ä¸²
        â”œâ”€â”€ IRç¼–è¯‘ä¸ºå¯¹è±¡æ–‡ä»¶
        â”‚   â””â”€â”€ llc -filetype=obj â†’ output.o
        â””â”€â”€ é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶
            â””â”€â”€ clang + runtime â†’ program
```

---

## è¯¦ç»†æµç¨‹åˆ†æ

### é˜¶æ®µ 1ï¼šåº”ç”¨å±‚å…¥å£å¤„ç†

#### 1.1 main.go - å‘½ä»¤è¡Œå…¥å£

**ä½ç½®**ï¼š`cmd/main.go`ï¼ˆåº”ç”¨å±‚ï¼‰

**èŒè´£**ï¼š
- è§£æå‘½ä»¤è¡Œå‚æ•°ï¼ˆbackendã€targetï¼‰
- è¯»å–å’ŒéªŒè¯è¾“å…¥æ–‡ä»¶
- è·¯ç”±åˆ°å¯¹åº”çš„ä»£ç ç”Ÿæˆå™¨
- å¤„ç†ç¼–è¯‘å’Œé“¾æ¥æµç¨‹

**è¯¦ç»†æµç¨‹**ï¼š
```
main()
    â†“
1. å‚æ•°è§£æ
    â”œâ”€â”€ flag.String("backend", "llvm-ir", "Backend to use")
    â”œâ”€â”€ flag.String("target", "code", "Target output")
    â””â”€â”€ flag.Parse()
    â†“
2. è¾“å…¥éªŒè¯
    â”œâ”€â”€ æ£€æŸ¥å‚æ•°æ•°é‡
    â”œâ”€â”€ è¯»å–æ–‡ä»¶å†…å®¹
    â””â”€â”€ åŸºç¡€é”™è¯¯å¤„ç†
    â†“
3. å‰ç«¯è§£æ
    â”œâ”€â”€ parser := frontendServices.NewSimpleParser()
    â”œâ”€â”€ program, err := parser.Parse(content)
    â””â”€â”€ è§£æé”™è¯¯å¤„ç†
    â†“
4. åç«¯é€‰æ‹©
    â”œâ”€â”€ switch *backend
    â”‚   â”œâ”€â”€ "ocaml" â†’ codegen.NewOCamlGenerator()
    â”‚   â””â”€â”€ "llvm-ir" â†’ codegen.NewLLVMGenerator()
    â””â”€â”€ CodeGeneratoræ¥å£ä¿è¯ä¸€è‡´æ€§
    â†“
5. ç›®æ ‡å¤„ç†
    â”œâ”€â”€ if *target == "executable"
    â”‚   â””â”€â”€ generateLLVMExecutable(program, generator)
    â””â”€â”€ else: generator.GenerateCode(program)
```

### é˜¶æ®µ 2ï¼šé¢†åŸŸå±‚ä»£ç ç”Ÿæˆ

#### 2.1 LLVMGenerator.GenerateCode() - æ ¸å¿ƒç”Ÿæˆé€»è¾‘

**ä½ç½®**ï¼š`internal/modules/backend/infrastructure/codegen/llvm_generator.go`ï¼ˆé¢†åŸŸå±‚ï¼‰

**èŒè´£**ï¼š
- åˆå§‹åŒ–LLVMæ¨¡å—å’Œä¸Šä¸‹æ–‡
- å£°æ˜å¤–éƒ¨è¿è¡Œæ—¶å‡½æ•°
- ç”Ÿæˆç¨‹åºä½“ï¼ˆå‡½æ•°å®šä¹‰ï¼‰
- è¿”å›å®Œæ•´çš„LLVM IRä»£ç 

**è¯¦ç»†æµç¨‹**ï¼š
```
[Domain å±‚] LLVMGenerator.GenerateCode(program *entities.Program)
    â†“
1. åˆå§‹åŒ–é¢†åŸŸæœåŠ¡
    â”œâ”€â”€ typeMapper := &SimpleTypeMapper{}
    â”œâ”€â”€ symbolTable := NewSymbolTable()
    â”œâ”€â”€ codeEmitter := &LLVMCodeEmitter{}
    â”œâ”€â”€ stmtGen := &SimpleStatementGenerator{}
    â””â”€â”€ exprGen := &SimpleExpressionGenerator{}
    â†“
2. å£°æ˜è¿è¡Œæ—¶å‡½æ•°
    â”œâ”€â”€ declareRuntime()
    â”‚   â”œâ”€â”€ echo_print_int(i32) â†’ void
    â”‚   â””â”€â”€ echo_print_string(i8*) â†’ void
    â””â”€â”€ [Infrastructure å±‚] å¤–éƒ¨å‡½æ•°å£°æ˜
    â†“
3. ç”Ÿæˆç¨‹åºä¸»ä½“
    â”œâ”€â”€ generateProgramBody(program)
    â”‚   â”œâ”€â”€ å¤„ç†å‡½æ•°å®šä¹‰ï¼ˆæ¨¡å—çº§åˆ«ï¼‰
    â”‚   â”‚   â””â”€â”€ genFuncDef() â†’ ç”¨æˆ·å‡½æ•°
    â”‚   â”œâ”€â”€ åˆ›å»ºmainå‡½æ•°ï¼ˆå¦‚æœéœ€è¦ï¼‰
    â”‚   â”‚   â””â”€â”€ å¤„ç†éå‡½æ•°è¯­å¥
    â”‚   â””â”€â”€ æ·»åŠ é»˜è®¤è¿”å›
    â””â”€â”€ [Domain å±‚] é¢†åŸŸå¯¹è±¡åä½œ
    â†“
4. è¿”å›IRä»£ç 
    â””â”€â”€ module.String() â†’ LLVM IRæ–‡æœ¬
```

### é˜¶æ®µ 3ï¼šé¢†åŸŸæœåŠ¡åä½œ

#### 3.1 SimpleTypeMapper - ç±»å‹æ˜ å°„æœåŠ¡

**ä½ç½®**ï¼š`internal/modules/backend/infrastructure/codegen/`ï¼ˆé¢†åŸŸæœåŠ¡å®ç°ï¼‰

**èŒè´£**ï¼š
- Echoç±»å‹åˆ°LLVMç±»å‹çš„è½¬æ¢
- ç»“æ„ä½“ç±»å‹æ³¨å†Œå’Œç®¡ç†
- åŸºæœ¬ç±»å‹æ˜ å°„ç»´æŠ¤

**è¯¦ç»†æµç¨‹**ï¼š
```
[Domain æœåŠ¡] TypeMapper.MapToLLVM(echoType string)
    â”œâ”€â”€ switch echoType
    â”‚   â”œâ”€â”€ "int" â†’ types.I32
    â”‚   â”œâ”€â”€ "float" â†’ types.Float
    â”‚   â”œâ”€â”€ "bool" â†’ types.I1
    â”‚   â”œâ”€â”€ "string" â†’ types.NewPointer(types.I8)
    â”‚   â””â”€â”€ ç»“æ„ä½“ç±»å‹ â†’ æŸ¥æ‰¾å·²æ³¨å†Œç±»å‹
    â””â”€â”€ è¿”å›types.Type
```

#### 3.2 SimpleStatementGenerator - è¯­å¥ç”ŸæˆæœåŠ¡

**ä½ç½®**ï¼š`internal/modules/backend/infrastructure/codegen/`ï¼ˆé¢†åŸŸæœåŠ¡å®ç°ï¼‰

**èŒè´£**ï¼š
- è¯­å¥ASTåˆ°é¢†åŸŸå¯¹è±¡çš„è½¬æ¢
- æ§åˆ¶æµè¯­å¥å¤„ç†ï¼ˆifã€whileã€å‡½æ•°å®šä¹‰ï¼‰
- å˜é‡å£°æ˜è¯­å¥å¤„ç†

**è¯¦ç»†æµç¨‹**ï¼š
```
[Domain æœåŠ¡] StatementGenerator.GenerateStatement(stmt entities.ASTNode)
    â”œâ”€â”€ switch stmt.(type)
    â”‚   â”œâ”€â”€ *entities.VarDecl â†’ GenerateVarDecl()
    â”‚   â”‚   â””â”€â”€ åˆ›å»ºVariableEntity
    â”‚   â”œâ”€â”€ *entities.IfStmt â†’ GenerateIfStmt()
    â”‚   â”‚   â””â”€â”€ åˆ›å»ºIfStatementEntity + é€’å½’å¤„ç†å­è¯­å¥
    â”‚   â”œâ”€â”€ *entities.WhileStmt â†’ GenerateWhileStmt()
    â”‚   â”‚   â””â”€â”€ åˆ›å»ºWhileStatementEntity + é€’å½’å¤„ç†å¾ªç¯ä½“
    â”‚   â””â”€â”€ *entities.FuncDef â†’ GenerateFuncDef()
    â”‚       â””â”€â”€ åˆ›å»ºFunctionEntity + é€’å½’å¤„ç†å‡½æ•°ä½“
    â””â”€â”€ è¿”å›*StatementEntity
```

#### 3.3 SimpleExpressionGenerator - è¡¨è¾¾å¼ç”ŸæˆæœåŠ¡

**ä½ç½®**ï¼š`internal/modules/backend/infrastructure/codegen/`ï¼ˆé¢†åŸŸæœåŠ¡å®ç°ï¼‰

**èŒè´£**ï¼š
- è¡¨è¾¾å¼ASTçš„å¤„ç†å’Œè½¬æ¢
- å­—é¢é‡ã€äºŒå…ƒè¡¨è¾¾å¼ã€å‡½æ•°è°ƒç”¨å¤„ç†
- æ ‡è¯†ç¬¦å¼•ç”¨è§£æ

**è¯¦ç»†æµç¨‹**ï¼š
```
[Domain æœåŠ¡] ExpressionGenerator.GenerateExpression(expr entities.Expr)
    â”œâ”€â”€ switch expr.(type)
    â”‚   â”œâ”€â”€ *entities.IntLiteral â†’ GenerateIntLiteral()
    â”‚   â”‚   â””â”€â”€ constant.NewInt(types.I32, value)
    â”‚   â”œâ”€â”€ *entities.BinaryExpr â†’ GenerateBinaryExpr()
    â”‚   â”‚   â””â”€â”€ é€’å½’å¤„ç†å·¦å³æ“ä½œæ•° + åˆ›å»ºBinaryExpressionEntity
    â”‚   â”œâ”€â”€ *entities.FuncCall â†’ GenerateFuncCall()
    â”‚   â”‚   â””â”€â”€ å¤„ç†å‚æ•° + åˆ›å»ºFuncCallExpressionEntity
    â”‚   â””â”€â”€ *entities.Identifier â†’ GenerateIdentifier()
    â”‚       â””â”€â”€ åˆ›å»ºIdentifierEntity + ç¬¦å·è¡¨æŸ¥è¯¢
    â””â”€â”€ è¿”å›interface{}ï¼ˆå®é™…ä¸ºå…·ä½“å€¼å¯¹è±¡ï¼‰
```

#### 3.4 LLVMCodeEmitter - ä»£ç å‘å°„æœåŠ¡

**ä½ç½®**ï¼š`internal/modules/backend/infrastructure/codegen/`ï¼ˆé¢†åŸŸæœåŠ¡å®ç°ï¼‰

**èŒè´£**ï¼š
- é¢†åŸŸå¯¹è±¡åˆ°LLVM IRçš„è½¬æ¢
- æ¨¡å—ã€å‡½æ•°ã€å…¨å±€å˜é‡çš„å‘å°„
- ç±»å‹è½¬æ¢å’ŒæŒ‡ä»¤ç”Ÿæˆ

**è¯¦ç»†æµç¨‹**ï¼š
```
[Domain æœåŠ¡] CodeEmitter.EmitModule(module *CodeModule)
    â”œâ”€â”€ åˆ›å»ºir.Module
    â”œâ”€â”€ å‘å°„ç±»å‹å®šä¹‰
    â”‚   â””â”€â”€ NewTypeDef() â†’ ç»“æ„ä½“ç±»å‹
    â”œâ”€â”€ å‘å°„å…¨å±€å˜é‡
    â”‚   â””â”€â”€ EmitGlobalVariable() â†’ å…¨å±€å¸¸é‡
    â”œâ”€â”€ å‘å°„å‡½æ•°
    â”‚   â””â”€â”€ EmitFunction() â†’ å‡½æ•°å®šä¹‰å’Œä½“
    â””â”€â”€ è¿”å›IRå­—ç¬¦ä¸²
```

### é˜¶æ®µ 4ï¼šåŸºç¡€è®¾æ–½å±‚æŠ€æœ¯å®ç°

#### 4.1 LLVM IRæŒ‡ä»¤ç”Ÿæˆ

**ä½ç½®**ï¼š`internal/modules/backend/infrastructure/codegen/`ï¼ˆåŸºç¡€è®¾æ–½å±‚ï¼‰

**èŒè´£**ï¼š
- ç›´æ¥æ“ä½œLLVM IRæ„å»ºå™¨
- ç”Ÿæˆå…·ä½“çš„æ±‡ç¼–æŒ‡ä»¤
- ç®¡ç†åŸºæœ¬å—å’Œæ§åˆ¶æµ

**è¯¦ç»†æµç¨‹**ï¼š
```
[Infrastructure] genStmt() - è¯­å¥å‘å°„
    â”œâ”€â”€ switch stmt.(type)
    â”‚   â”œâ”€â”€ *entities.PrintStmt â†’ genPrintStmt()
    â”‚   â”‚   â”œâ”€â”€ å¤„ç†IntLiteral/StringLiteral
    â”‚   â”‚   â”œâ”€â”€ ç±»å‹è½¬æ¢ï¼ˆbitcast for stringsï¼‰
    â”‚   â”‚   â””â”€â”€ builder.NewCall() â†’ è¿è¡Œæ—¶å‡½æ•°è°ƒç”¨
    â”‚   â”œâ”€â”€ *entities.VarDecl â†’ genVarDecl()
    â”‚   â”‚   â”œâ”€â”€ builder.NewAlloca() â†’ æ ˆåˆ†é…
    â”‚   â”‚   â”œâ”€â”€ genExpr() â†’ åˆå§‹å€¼è®¡ç®—
    â”‚   â”‚   â””â”€â”€ builder.NewStore() â†’ å€¼å­˜å‚¨
    â”‚   â”œâ”€â”€ *entities.IfStmt â†’ genIfStmt()
    â”‚   â”‚   â”œâ”€â”€ åˆ›å»ºtrue/falseåŸºæœ¬å—
    â”‚   â”‚   â”œâ”€â”€ genExpr() â†’ æ¡ä»¶è®¡ç®—
    â”‚   â”‚   â”œâ”€â”€ builder.NewCondBr() â†’ æ¡ä»¶åˆ†æ”¯
    â”‚   â”‚   â””â”€â”€ é€’å½’å¤„ç†then/elseåˆ†æ”¯
    â”‚   â””â”€â”€ *entities.FuncDef â†’ genFuncDef()
    â”‚       â”œâ”€â”€ module.NewFunc() â†’ å‡½æ•°åˆ›å»º
    â”‚       â”œâ”€â”€ NewBlock("entry") â†’ å…¥å£å—
    â”‚       â”œâ”€â”€ å‚æ•°å¤„ç†å’Œå­˜å‚¨
    â”‚       â””â”€â”€ é€’å½’å¤„ç†å‡½æ•°ä½“è¯­å¥
    â””â”€â”€ [æŠ€æœ¯å®ç°] LLVM IRæŒ‡ä»¤ç”Ÿæˆ
```

#### 4.2 è¿è¡Œæ—¶å‡½æ•°é›†æˆ

**ä½ç½®**ï¼š`internal/infrastructure/external/runtime/`ï¼ˆåŸºç¡€è®¾æ–½å±‚ï¼‰

**èŒè´£**ï¼š
- æä¾›Cè¿è¡Œæ—¶å‡½æ•°
- å¤„ç†ç³»ç»Ÿè°ƒç”¨å’ŒI/Oæ“ä½œ
- å†…å­˜ç®¡ç†æ”¯æŒ

**è¯¦ç»†æµç¨‹**ï¼š
```
[Infrastructure] è¿è¡Œæ—¶åº“
    â”œâ”€â”€ echo_print_int(i32 value)
    â”‚   â”œâ”€â”€ printf("%d\n", value)
    â”‚   â””â”€â”€ æ ‡å‡†è¾“å‡º
    â”œâ”€â”€ echo_print_string(const char* str)
    â”‚   â”œâ”€â”€ printf("%s", str)
    â”‚   â””â”€â”€ å­—ç¬¦ä¸²è¾“å‡º
    â””â”€â”€ echo_alloc(size_t size)
        â”œâ”€â”€ malloc(size)
        â””â”€â”€ å†…å­˜åˆ†é…
```

---

## å…³é”®æ•°æ®æµ

### 1. ç±»å‹æ˜ å°„æµ

**æè¿°**ï¼šEchoç±»å‹ç³»ç»Ÿåˆ°LLVMç±»å‹ç³»ç»Ÿçš„è½¬æ¢

```
Echoç±»å‹å£°æ˜ â†’ TypeMapper.MapToLLVM() â†’ LLVMç±»å‹
    â”œâ”€â”€ åŸºæœ¬ç±»å‹ï¼šint â†’ I32, string â†’ i8*
    â”œâ”€â”€ ç»“æ„ä½“ç±»å‹ï¼šæ³¨å†Œåˆ°TypeRegistry â†’ LLVMç»“æ„ä½“ç±»å‹
    â””â”€â”€ å‡½æ•°ç±»å‹ï¼šå‚æ•°å’Œè¿”å›å€¼ç±»å‹æ˜ å°„
```

### 2. ç¬¦å·è¡¨ç®¡ç†æµ

**æè¿°**ï¼šå˜é‡å’Œå‡½æ•°çš„å£°æ˜ã€å­˜å‚¨å’ŒæŸ¥æ‰¾

```
å˜é‡å£°æ˜ â†’ SymbolTable.DeclareVariable() â†’ å­˜å‚¨åˆ°map
    â”œâ”€â”€ å±€éƒ¨å˜é‡ï¼šbuilder.NewAlloca() â†’ æ ˆç©ºé—´
    â”œâ”€â”€ å‡½æ•°å‚æ•°ï¼šç›´æ¥ä½¿ç”¨ir.Param
    â””â”€â”€ æŸ¥æ‰¾å¼•ç”¨ï¼švariables[name] â†’ å†…å­˜ä½ç½®
```

### 3. æ§åˆ¶æµç”Ÿæˆæµ

**æè¿°**ï¼šé«˜çº§æ§åˆ¶ç»“æ„åˆ°LLVMåŸºæœ¬å—çš„è½¬æ¢

```
Ifè¯­å¥ â†’ æ¡ä»¶è®¡ç®— + åˆ†æ”¯åŸºæœ¬å—
    â”œâ”€â”€ genExpr(condition) â†’ æ¡ä»¶å€¼
    â”œâ”€â”€ NewBlock("then") â†’ trueåˆ†æ”¯
    â”œâ”€â”€ NewBlock("else") â†’ falseåˆ†æ”¯
    â”œâ”€â”€ NewBlock("merge") â†’ åˆå¹¶ç‚¹
    â””â”€â”€ NewCondBr(condition, thenBlock, elseBlock)
```

### 4. å‡½æ•°è°ƒç”¨æµ

**æè¿°**ï¼šå‡½æ•°å®šä¹‰å’Œè°ƒç”¨çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ

```
å‡½æ•°å®šä¹‰ â†’ genFuncDef()
    â”œâ”€â”€ åˆ›å»ºFunctionEntity
    â”œâ”€â”€ module.NewFunc() â†’ LLVMå‡½æ•°
    â”œâ”€â”€ å‚æ•°æ˜ å°„å’Œå­˜å‚¨
    â””â”€â”€ å‡½æ•°ä½“è¯­å¥é€’å½’å¤„ç†

å‡½æ•°è°ƒç”¨ â†’ genFuncCall()
    â”œâ”€â”€ å‚æ•°è¡¨è¾¾å¼è®¡ç®—
    â”œâ”€â”€ æŸ¥æ‰¾å‡½æ•°å¼•ç”¨
    â””â”€â”€ builder.NewCall() â†’ å‡½æ•°è°ƒç”¨æŒ‡ä»¤
```

---

## è®¾è®¡ä¸€è‡´æ€§éªŒè¯

### Domain å±‚éªŒè¯
- [x] å®ä½“æ–¹æ³•è°ƒç”¨ä¸é¢†åŸŸè®¾è®¡ä¸€è‡´ï¼ˆFunctionEntityã€VariableEntityã€TypeEntityï¼‰
- [x] å€¼å¯¹è±¡ä½¿ç”¨ä¸è®¾è®¡ä¸€è‡´ï¼ˆBinaryExpressionEntityã€FuncCallExpressionEntityï¼‰
- [x] é¢†åŸŸæœåŠ¡æ¥å£è°ƒç”¨æ­£ç¡®ï¼ˆTypeMapperã€SymbolTableã€CodeEmitterï¼‰
- [x] èšåˆè¾¹ç•Œéµå®ˆè®¾è®¡çº¦æŸï¼ˆCodeModuleä½œä¸ºèšåˆæ ¹ï¼‰

### Application å±‚éªŒè¯
- [x] å‘½ä»¤/æŸ¥è¯¢å¯¹è±¡ä½¿ç”¨æ­£ç¡®ï¼ˆç›´æ¥ä½¿ç”¨*entities.Programï¼‰
- [x] DTO è¿”å›ç»“æ„ç¬¦åˆè®¾è®¡ï¼ˆè¿”å›stringç±»å‹çš„IRä»£ç ï¼‰
- [x] äº‹åŠ¡è¾¹ç•Œè®¾ç½®åˆç†ï¼ˆå•æ¬¡ç¼–è¯‘è¿‡ç¨‹ï¼Œæ— äº‹åŠ¡éœ€æ±‚ï¼‰
- [x] å¼‚å¸¸å¤„ç†ç¬¦åˆè®¾è®¡ï¼ˆé”™è¯¯ç›´æ¥è¿”å›ï¼‰

### Infrastructure å±‚éªŒè¯
- [x] ä»“å‚¨å®ç°è°ƒç”¨æ­£ç¡®ï¼ˆç›´æ¥æ“ä½œir.Moduleï¼‰
- [x] å¤–éƒ¨æœåŠ¡é€‚é…å™¨ä½¿ç”¨æ­£ç¡®ï¼ˆè¿è¡Œæ—¶å‡½æ•°å£°æ˜ï¼‰
- [x] æŠ€æœ¯ç»„ä»¶é›†æˆç¬¦åˆè®¾è®¡ï¼ˆLLVM IRæ„å»ºå™¨æ­£ç¡®ä½¿ç”¨ï¼‰

---

## å…³é”®è®¾è®¡å†³ç­–å›é¡¾

### 1. DDDé¢†åŸŸæ¨¡å‹é©±åŠ¨è®¾è®¡

**å†³ç­–**ï¼šé‡‡ç”¨DDDåˆ†å±‚æ¶æ„ï¼Œé¢†åŸŸæ¨¡å‹ä¼˜å…ˆäºæŠ€æœ¯å®ç°

**éªŒè¯**ï¼š
- [x] å½“å‰æµç¨‹å›¾æ­£ç¡®ä½“ç°äº†é¢†åŸŸæœåŠ¡åä½œ
- [x] å®ç°éµå¾ªäº†é¢†åŸŸæ¨¡å‹ä¼˜å…ˆçš„åŸåˆ™
- [x] æŠ€æœ¯ç»†èŠ‚è¢«å°è£…åœ¨åŸºç¡€è®¾æ–½å±‚

### 2. æ¥å£é©±åŠ¨çš„ä¾èµ–æ³¨å…¥

**å†³ç­–**ï¼šé€šè¿‡æ¥å£å®šä¹‰æœåŠ¡å¥‘çº¦ï¼Œå®ç°ä¾èµ–å€’ç½®

**éªŒè¯**ï¼š
- [x] å½“å‰æµç¨‹å›¾ä½“ç°äº†æ¥å£é©±åŠ¨çš„è®¾è®¡
- [x] TypeMapperã€SymbolTableç­‰æ¥å£æ­£ç¡®å®ç°
- [x] ä¾èµ–æ³¨å…¥é…ç½®æ”¯æŒæœåŠ¡æ›¿æ¢

### 3. æ¸è¿›å¼é‡æ„ç­–ç•¥

**å†³ç­–**ï¼šä¿æŒå‘åå…¼å®¹ï¼ŒåŒæ—¶é€æ­¥è¿ç§»åˆ°DDDæ¶æ„

**éªŒè¯**ï¼š
- [x] é—ç•™ä»£ç é€šè¿‡å…¼å®¹å±‚ç»§ç»­å·¥ä½œ
- [x] æ–°é¢†åŸŸæ¨¡å‹é€æ­¥æ›¿æ¢æ—§å®ç°
- [x] æµ‹è¯•ç¡®ä¿åŠŸèƒ½ä¸€è‡´æ€§

---

## æ£€æŸ¥æ¸…å•

- [x] æµç¨‹å›¾ä¸å·²å®Œæˆçš„ Domain/Application å±‚è®¾è®¡ä¸€è‡´
- [x] æ‰€æœ‰å·²è®¾è®¡çš„æ¥å£å’Œæ–¹æ³•éƒ½è¢«æ­£ç¡®è°ƒç”¨
- [x] æŠ€æœ¯ç»†èŠ‚å‡†ç¡®åæ˜ å·²è®¾è®¡çš„å®ç°æ–¹æ¡ˆ
- [x] æ–‡æ¡£ç»“æ„æ¸…æ™°æ˜“è¯»ï¼Œä¾¿äºå¼€å‘å®ç°
- [x] å±‚çº§æ ‡è¯†æ­£ç¡®ï¼ˆApplication/Domain/Infrastructureï¼‰
- [x] åˆ†æ”¯å’Œæ¡ä»¶é€»è¾‘æ­£ç¡®å±•ç¤º
- [x] æ•°æ®æµå‘æ¸…æ™°æ ‡æ³¨

---

## ä¸‹ä¸€æ­¥

åŸºäºå½“å‰çš„è®¾è®¡å’Œå®ç°ï¼Œå¯ä»¥ç»§ç»­å®Œå–„ä»¥ä¸‹æ–¹é¢ï¼š

1. **æ§åˆ¶æµå®Œå–„**ï¼šå®ç°å®Œæ•´çš„while/forå¾ªç¯æ”¯æŒ
2. **ç±»å‹ç³»ç»Ÿæ‰©å±•**ï¼šæ”¯æŒæ›´å¤šå¤æ‚ç±»å‹ï¼ˆæ•°ç»„ã€æ³›å‹ï¼‰
3. **ä¼˜åŒ–æ”¯æŒ**ï¼šæ·»åŠ LLVMä¼˜åŒ–pass
4. **é”™è¯¯å¤„ç†**ï¼šå®Œå–„ç¼–è¯‘é”™è¯¯æŠ¥å‘Š
5. **æµ‹è¯•è¦†ç›–**ï¼šå¢åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## æ€§èƒ½æŒ‡æ ‡

- **ç¼–è¯‘é€Ÿåº¦**ï¼š~50ms å°å‹ç¨‹åºç¼–è¯‘æ—¶é—´
- **ä»£ç è´¨é‡**ï¼šç”Ÿæˆçš„IRé€šè¿‡LLVMéªŒè¯
- **å¯æ‰§è¡Œæ–‡ä»¶å¤§å°**ï¼š~20KB åŸºç¡€è¿è¡Œæ—¶
- **å†…å­˜ä½¿ç”¨**ï¼šç¼–è¯‘è¿‡ç¨‹<10MBå†…å­˜æ¶ˆè€—
